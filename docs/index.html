<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extract Metadata from 'NetCDF' Files as Data Frames • ncdump</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ncdump</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<!-- README.md is generated from README.Rmd. Please edit that file -->

<div id="netcdf-metadata-in-tables-in-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#netcdf-metadata-in-tables-in-r" class="anchor"></a>NetCDF metadata in tables in R</h1></div>
<p>The <code>ncdump</code> package aims to simplify the way we can approach NetCDF in R.</p>
<p>Currently the only real functionality is to return the complete file metadata in tidy form. There is some experimental function to return specific entities, but in my experience the existing tools <code>ncdf4</code>, <code>raster</code>, <code>rgdal</code>, <code>RNetCDF</code> and <code>rhdf5</code> are sufficient for easily accessing almost everything. Where they fall down is in providing easy and complete information about what is available in the files, so that’s where <code>ncdump::NetCDF</code> comes in.</p>
<p>Create an object that has a complete description of the file so that we can easily see the available <strong>variables</strong> and <strong>dimensions</strong> and <strong>attributes</strong>, and perform queries that find the details we need in a form we can used, rather than just printed out on the screen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ncdump)

ifile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"S2008001.L3m_DAY_CHL_chlor_a_9km.nc"</span>, <span class="dt">package =</span> <span class="st">"ncdump"</span>)
con &lt;-<span class="st"> </span><span class="kw"><a href="reference/NetCDF.html">NetCDF</a></span>(ifile)</code></pre></div>
<p>Note that this is just the <em>metadata</em> in the file, but we’ve organized it into a tidy list of tables so we can use it.</p>
<p>It looks good when we print those tables out, and it’s pretty clear how we can use this information to drive the reader functions in the API packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for (i in <span class="kw">seq_along</span>(con)) {
  <span class="kw">print</span>(<span class="kw">names</span>(con)[i])
  <span class="kw">print</span>(con[[i]])
}
<span class="co">#&gt; [1] "dimension"</span>
<span class="co">#&gt; # A tibble: 4 × 7</span>
<span class="co">#&gt;            name   len unlim group_index group_id    id create_dimvar</span>
<span class="co">#&gt;           &lt;chr&gt; &lt;int&gt; &lt;lgl&gt;       &lt;int&gt;    &lt;int&gt; &lt;int&gt;         &lt;lgl&gt;</span>
<span class="co">#&gt; 1           lat  2160 FALSE           1    65536     0          TRUE</span>
<span class="co">#&gt; 2           lon  4320 FALSE           1    65536     1          TRUE</span>
<span class="co">#&gt; 3           rgb     3 FALSE           1    65536     2         FALSE</span>
<span class="co">#&gt; 4 eightbitcolor   256 FALSE           1    65536     3         FALSE</span>
<span class="co">#&gt; [1] "unlimdims"</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; [1] "dimvals"</span>
<span class="co">#&gt; # A tibble: 6,739 × 2</span>
<span class="co">#&gt;       id     vals</span>
<span class="co">#&gt;    &lt;int&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1      0 89.95834</span>
<span class="co">#&gt; 2      0 89.87500</span>
<span class="co">#&gt; 3      0 89.79167</span>
<span class="co">#&gt; 4      0 89.70834</span>
<span class="co">#&gt; 5      0 89.62500</span>
<span class="co">#&gt; 6      0 89.54167</span>
<span class="co">#&gt; 7      0 89.45834</span>
<span class="co">#&gt; 8      0 89.37500</span>
<span class="co">#&gt; 9      0 89.29167</span>
<span class="co">#&gt; 10     0 89.20834</span>
<span class="co">#&gt; # ... with 6,729 more rows</span>
<span class="co">#&gt; [1] "groups"</span>
<span class="co">#&gt; # A tibble: 3 × 6</span>
<span class="co">#&gt;      id               name ndims nvars natts</span>
<span class="co">#&gt;   &lt;int&gt;              &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 65536                        4     4    65</span>
<span class="co">#&gt; 2 65537 processing_control     0     0     4</span>
<span class="co">#&gt; 3 65538   input_parameters     0     0    21</span>
<span class="co">#&gt; # ... with 1 more variables: fqgn &lt;chr&gt;</span>
<span class="co">#&gt; [1] "file"</span>
<span class="co">#&gt; # A tibble: 1 × 10</span>
<span class="co">#&gt;                                                                      filename</span>
<span class="co">#&gt;                                                                         &lt;chr&gt;</span>
<span class="co">#&gt; 1 /home/mdsumner/R/x86_64-pc-linux-gnu-library/3.4/ncdump/extdata/S2008001.L3</span>
<span class="co">#&gt; # ... with 9 more variables: writable &lt;lgl&gt;, id &lt;int&gt;, safemode &lt;lgl&gt;,</span>
<span class="co">#&gt; #   format &lt;chr&gt;, is_GMT &lt;lgl&gt;, ndims &lt;dbl&gt;, natts &lt;dbl&gt;,</span>
<span class="co">#&gt; #   unlimdimid &lt;dbl&gt;, nvars &lt;dbl&gt;</span>
<span class="co">#&gt; [1] "variable"</span>
<span class="co">#&gt; # A tibble: 2 × 18</span>
<span class="co">#&gt;      name ndims natts          prec   units</span>
<span class="co">#&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt;         &lt;chr&gt;   &lt;chr&gt;</span>
<span class="co">#&gt; 1 chlor_a     2    12         float mg m^-3</span>
<span class="co">#&gt; 2 palette     2     0 unsigned byte        </span>
<span class="co">#&gt; # ... with 13 more variables: longname &lt;chr&gt;, group_index &lt;int&gt;,</span>
<span class="co">#&gt; #   storage &lt;int&gt;, shuffle &lt;int&gt;, compression &lt;int&gt;, unlim &lt;lgl&gt;,</span>
<span class="co">#&gt; #   make_missing_value &lt;lgl&gt;, missval &lt;dbl&gt;, hasAddOffset &lt;lgl&gt;,</span>
<span class="co">#&gt; #   addOffset &lt;dbl&gt;, hasScaleFact &lt;lgl&gt;, scaleFact &lt;dbl&gt;, id &lt;dbl&gt;</span>
<span class="co">#&gt; [1] "vardim"</span>
<span class="co">#&gt; # A tibble: 4 × 2</span>
<span class="co">#&gt;      id dimids</span>
<span class="co">#&gt;   &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">#&gt; 1     0      1</span>
<span class="co">#&gt; 2     0      0</span>
<span class="co">#&gt; 3     3      3</span>
<span class="co">#&gt; 4     3      2</span>
<span class="co">#&gt; [1] "attribute"</span>
<span class="co">#&gt; [1] "NetCDF attributes:"</span>
<span class="co">#&gt; [1] "Global"</span>
<span class="co">#&gt; [1] "\n"</span>
<span class="co">#&gt; # A tibble: 1 × 65</span>
<span class="co">#&gt;                          product_name instrument</span>
<span class="co">#&gt;                                 &lt;chr&gt;      &lt;chr&gt;</span>
<span class="co">#&gt; 1 S2008001.L3m_DAY_CHL_chlor_a_9km.nc    SeaWiFS</span>
<span class="co">#&gt; # ... with 63 more variables: title &lt;chr&gt;, project &lt;chr&gt;, platform &lt;chr&gt;,</span>
<span class="co">#&gt; #   temporal_range &lt;chr&gt;, processing_version &lt;chr&gt;, date_created &lt;chr&gt;,</span>
<span class="co">#&gt; #   history &lt;chr&gt;, l2_flag_names &lt;chr&gt;, time_coverage_start &lt;chr&gt;,</span>
<span class="co">#&gt; #   time_coverage_end &lt;chr&gt;, start_orbit_number &lt;int&gt;,</span>
<span class="co">#&gt; #   end_orbit_number &lt;int&gt;, map_projection &lt;chr&gt;, latitude_units &lt;chr&gt;,</span>
<span class="co">#&gt; #   longitude_units &lt;chr&gt;, northernmost_latitude &lt;dbl&gt;,</span>
<span class="co">#&gt; #   southernmost_latitude &lt;dbl&gt;, westernmost_longitude &lt;dbl&gt;,</span>
<span class="co">#&gt; #   easternmost_longitude &lt;dbl&gt;, geospatial_lat_max &lt;dbl&gt;,</span>
<span class="co">#&gt; #   geospatial_lat_min &lt;dbl&gt;, geospatial_lon_max &lt;dbl&gt;,</span>
<span class="co">#&gt; #   geospatial_lon_min &lt;dbl&gt;, grid_mapping_name &lt;chr&gt;,</span>
<span class="co">#&gt; #   latitude_step &lt;dbl&gt;, longitude_step &lt;dbl&gt;, sw_point_latitude &lt;dbl&gt;,</span>
<span class="co">#&gt; #   sw_point_longitude &lt;dbl&gt;, geospatial_lon_resolution &lt;dbl&gt;,</span>
<span class="co">#&gt; #   geospatial_lat_resolution &lt;dbl&gt;, geospatial_lat_units &lt;chr&gt;,</span>
<span class="co">#&gt; #   geospatial_lon_units &lt;chr&gt;, spatialResolution &lt;chr&gt;, data_bins &lt;int&gt;,</span>
<span class="co">#&gt; #   number_of_lines &lt;int&gt;, number_of_columns &lt;int&gt;, measure &lt;chr&gt;,</span>
<span class="co">#&gt; #   data_minimum &lt;dbl&gt;, data_maximum &lt;dbl&gt;,</span>
<span class="co">#&gt; #   suggested_image_scaling_minimum &lt;dbl&gt;,</span>
<span class="co">#&gt; #   suggested_image_scaling_maximum &lt;dbl&gt;,</span>
<span class="co">#&gt; #   suggested_image_scaling_type &lt;chr&gt;,</span>
<span class="co">#&gt; #   suggested_image_scaling_applied &lt;chr&gt;, `_lastModified` &lt;chr&gt;,</span>
<span class="co">#&gt; #   Conventions &lt;chr&gt;, institution &lt;chr&gt;, standard_name_vocabulary &lt;chr&gt;,</span>
<span class="co">#&gt; #   Metadata_Conventions &lt;chr&gt;, naming_authority &lt;chr&gt;, id &lt;chr&gt;,</span>
<span class="co">#&gt; #   license &lt;chr&gt;, creator_name &lt;chr&gt;, publisher_name &lt;chr&gt;,</span>
<span class="co">#&gt; #   creator_email &lt;chr&gt;, publisher_email &lt;chr&gt;, creator_url &lt;chr&gt;,</span>
<span class="co">#&gt; #   publisher_url &lt;chr&gt;, processing_level &lt;chr&gt;, cdm_data_type &lt;chr&gt;,</span>
<span class="co">#&gt; #   identifier_product_doi_authority &lt;chr&gt;, identifier_product_doi &lt;chr&gt;,</span>
<span class="co">#&gt; #   keywords &lt;chr&gt;, keywords_vocabulary &lt;chr&gt;</span>
<span class="co">#&gt; [1] "\n"</span>
<span class="co">#&gt; [1] "Variable attributes:"</span>
<span class="co">#&gt; character(0)</span></code></pre></div>
<div id="rationale" class="section level2">
<h2 class="hasAnchor">
<a href="#rationale" class="anchor"></a>Rationale</h2>
<p>The main problems with the existing packages are that they are either too high-level or too low-level and it’s this twilight zone in the middle where <code>ncdump</code> comes in, where the user needs to reach down a bit deeper to make things work. Using the wrappers around the raw API <code>ncdf4</code> and <code>RNetCDF</code> is very raw, and for the most part is analogous to the NetCDF API itself, though you don’t have to compile the code. These packages aren’t the same, and neither can read all kinds of NetCDF files. Both do support API features like NetCDF 4, server interfaces (OpenDAP and Thredds and the like), support for HDF, and parallel processing but it depends on how you build the underlying libaries. The details on this are not on the agenda here.</p>
<p>The worker for most low-level NetCDF access is the command line utility <code>ncdump -h</code> - if not called with the <code>h</code>eader argument you can actually dump the data contents in various ways, including binary forms to other formats. The header is usually what you are expected to read to figure out how to program against the contents. It’s not completely automatable, because it’s so general it’s unlikely that your generalized code will solve any particular practical task and there’s no general libary for NetCDF that will give you practical outcomes for all types of data. It’s a non-virtuous cycle.</p>
<p>The <code>raster</code> package is excellent for NetCDF, but it only works “off-the-shelf” for regularly xy-gridded data in 2D, 3D or 4D variables. The mapping of dimensions to these variables is patchy, because the format is so general and many data variables have rectilinear or curvilinear coordinates, which are either ignored by raster or cause it to stop without reading anything. If you know what you want you can get it to work with any 2D or higher variable. Raster is a high-level domain-specific library, for GIS-y rasters, or grids that use an affine transform to define their coordinate system in xy.</p>
<p>GDAL, available in <code>rgdal</code> has similar limitations to raster for the same affine/GIS reason, but also makes different choices when approaching higher dimensions. Essentially all higher dimensions get unrolled as extra bands for a GDAL data set. They are completely independently implemented, GDAL has an in-built NetCDF driver (also a GMT variant) and raster uses <code>ncdf4</code> directly. (Raster will use <code>rgdal</code> when it can for many formats, but you cannot actually override raster’s used of ncdf4 without uninstalling that package. It’s all quite complicated and poorly understood unfortunately, and it keeps changing).</p>
<p>There is another package <code>rhdf5</code> which provides excellent modern facilities for HDF5 and NetCDF4, and notably this can read NetCDF files with compound types that no other package can do. This would be perfect if it could also read NetCDF “classic format”, i.e. version 3.x prior to NetCDF 4.</p>
<p>I use <code>ncdump</code> in conjunction with <code>angstroms</code> and various other projects. I can perform joins and select/filter tasks on the tables it returns, but it’s not designed in any high-level consistent way, it just gives all the information it can get.</p>
</div>
<div id="development" class="section level2">
<h2 class="hasAnchor">
<a href="#development" class="anchor"></a>Development</h2>
<p>A format method for the object above could recreate the print out you see from ncdump itself.</p>
<p>A future package may wrap the various NetCDF R packages to do the actual read, but each is useful in different ways. The main ones are <code>RNetCDF</code>, <code>ncdf4</code> and <code>rhdf5</code> (Bioconductor).</p>
<p>This project was split out of the “R and NetCDF interface development” project. <a href="https://github.com/mdsumner/rancid" class="uri">https://github.com/mdsumner/rancid</a></p>
<p>Please note that this project is released with a <a href="CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael D. Sumner <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/r-gris/ncdump"><img src="https://travis-ci.org/r-gris/ncdump.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/r-gris/ncdump"><img src="https://ci.appveyor.com/api/projects/status/github/r-gris/ncdump?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/github/r-gris/ncdump?branch=master"><img src="https://img.shields.io/codecov/c/github/r-gris/ncdump/master.svg" alt="Coverage Status"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
