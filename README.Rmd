---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

[![Travis-CI Build Status](https://travis-ci.org/r-gris/nc.svg?branch=master)](https://travis-ci.org/r-gris/nc)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/r-gris/nc?branch=master&svg=true)](https://ci.appveyor.com/project/r-gris/nc)
[![Coverage Status](https://img.shields.io/codecov/c/github/r-gris/nc/master.svg)](https://codecov.io/github/r-gris/nc?branch=master)


# R And NetCDF Interface Development

The `nc` package aims to simplify and systematize read-access to NetCDF in R. 

The basic workflow hides the underlying details of calls to the NetCDF API. 

Create an object that has a complete description of the file so that we can easily see the available variables (`vars`) and dimensions (`dims`), and perform queries that find the details we need in the form that we want, rather than just printed out on the screen. 

```{r}
library(dplyr)
library(nc)

ifile <- system.file("extdata", "S2008001.L3m_DAY_CHL_chlor_a_9km.nc", package = "nc")
con <- NetCDF(ifile)
```


```{r}
nc::vars(con)

dims(con)

## perform a join of variable to dimension, keeping only the varname and id
nc::vars(con) %>% dplyr::filter(name == "chlor_a") %>% transmute(varname = name, id) %>%  inner_join(con$vardim, "id") %>% inner_join(dims(con), c("dimids" = "id"))
```
<!--
```{r,echo=FALSE,eval=FALSE}
We can use this to build tools for simplified access, maybe.
getvar3d <- function(filename, varname) {
  meta <- NetCDF(filename)
  v <- vars(meta) %>% filter(name == varname) 
  dd <- v %>% transmute(varname = name, id) %>%  inner_join(meta$vardim, "id") %>% inner_join(dims(meta), c("dimids" = "id")) ## order by v list
  typ <- list(float = numeric, double = numeric, int = integer)[[v$prec]]
  val <- typ(1)
  var <- array(val, c(dd$len, nrow(meta$file)))
  for (ii in seq(nrow(meta$file))) {
    var[,,ii] <- ncdf4::ncvar_get(ncdf4::open_nc(meta$file$filename[ii]), varname)
  }
  
}
```
-->
